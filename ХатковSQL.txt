--Практ1
select distinct t.Tname
from T t
Join STD st on t.Tnum = st.Tnum
Join D d on st.Dnum = d.Dnum
Join S s on st.Snum = s.Snum
where d.City = s.City;

select distinct s.Sname
from S s
Join STD st on s.Snum =st.Snum
Join D d on st.Dnum = d.Dnum
where d.Dnum = 'D1';

select distinct D.City AS CityFrom, S.City AS CityTo
from D
Join STD on D.Dnum = STD.Dnum
Join S on STD.Snum = S.Snum
where D.City != S.City;

select distinct t.Tnum
from T t
Join STD st on t.Tnum = st.Tnum
Join S s on st.Snum = s.Snum
where s.Status > 50;

---------------------------------------
--Практ2
select distinct s.Sname
from S s
where s.Status between 50 and 100;

select count(distinct s.Snum)
from S s
where s.City = 'Москва';

select SUM(t.Price * st.Kolvo) AS TotalCost
from T t
Join STD st on t.Tnum = st.Tnum
Join D d on st.Dnum = d.Dnum
where d.Dnum = 'D1';

select 
    s.Sname, 
	AVG(t.Price) AS AvgPrice
from 
    S 
Join STD on S.Snum = STD.Snum
Join T on STD.Tnum = T.Tnum
Group by 
     S.Sname;

select distinct City from D
union
select distinct City from s;

-------------------------------------------
--Практ3
select distinct st.Snum
from STD st
where st.Kolvo > (
    select MAX(st2.Kolvo)
    from STD st2
    where st2.Snum = 'S1'
);
GO

select s.Snum
from S s
where s.Status < (select Status from S where Snum = 'S1');
GO

insert into Tovar_Temp
select *
from T
where Tnum in (select Tnum from T where Price > 1000 and EdIzm = 'пачка');


select Tnum, Tname, Price, EdIzm, City
From T
where Price > 1000 and EdIzm = 'пачка';
GO

update T
set Price = Price * 0.85
where City = 'Москва' and EdIzm like '%10 кг%'

delete from S
where Status < 20;
